---
title: "The States That Support Their Own"
subtitle: "Mini Project 2"
author: "Cai Ytsma, Juliane Bombosh, Sofia Salcedo"
date: "3/22/2018"
output: html_document
  code_folding: hide
---
<<<<<<< HEAD
# Relevance: 
**What we wanted to Achieve**
We have taken FEC data to examine politically active local communities. We created two data graphics, one represents donations made to democrat candidates the other republican candidates. We wanted to compare parties, loyalty, and which states have the most active local politics in terms of donations. 

#What We Did:
**Visual Cues & Data Source:**
Our data is from the candidates and contributions rda files. We utilized the image of a map and color saturation per state. Each state's saturation is based on the number of donations made to a candidate of that state. The higher the saturation the more donations were made to candidates of the repective party per state.

#Analysis:
a single coherent sentence what we can learn from these data
Looking at number of candidates, which should remove the bias of population
Where are dems or repus focusing donations? Where are the more active political regions?
Donations the most---> closer elections or long shots, or when they are trying to change the local political scene

Where would donations to candidates be the highest? Would it be in areas where there is high variability in the local political scene and donations can have more influence? Or in areas that are the opposite, with a stable majority in place?
Side note: throw something in to connect to the title of "donating to their own" and the idea of ignoring DC, outside influences

**Link to the repository** !!! NEEDS TO BE IN FOOTNOTES!!!


```{r, message = FALSE, warning = FALSE}
library(tidyverse)
library(maps)
library(mapdata)
library(ggplot2)
library(fiftystater)
```

```{r, label = "dataset import"}
load("house_elections.rda")
load("candidates.rda")
load("committees.rda")
load("contributions.rda")
```

```{r, label = "state list"}
state_inits <- c("AL", "AK", "AZ", "AR", "CA", "CO", "CT",
               "DE", "FL", "GA", "HI", "ID",
               "IL", "IN", "IA", "KS", "KY", "LA", "ME",
               "MD", "MA", "MI", "MN", "MS", "MO", "MT", "NE",
               "NV", "NH", "NJ", "NM", "NY", "NC", "ND",
               "OH", "OK", "OR", "PA", "RI", "SC", 
               "SD", "TN", "TX", "UT", "VT", "VA", "WA", 
               "WV", "WI", "WY")

state_names <- c("alabama", "alaska", "arizona", "arkansas", "california", "colorado", "connecticut", "delaware", "florida", "georgia", "hawaii", "idaho", "illinois", "indiana", "iowa", "kansas", "kentucky","louisiana", "maine", "maryland", "massachusetts", "michigan", "minnesota", "mississippi", "missouri", "montana", "nebraska", "nevada", "new hampshire", "new jersey", "new mexico", "new york", "north carolina", "north dakota", "ohio", "oklahoma", "oregon", "pennsylvania", "rhode island", "south carolina","south dakota", "tennessee", "texas", "utah", "vermont", "virginia", "washington", "west virginia", "wisconsin", "wyoming")
```

```{r}
state_code <- data.frame(state_inits, state_names)
names(state_code) <- c("initials", "name")
```

```{r, label = "prepare datasets for merge"}
contribution_code <- contributions %>%
  select(cand_id, state) %>%
  group_by(state) %>%
  mutate(donor_state = state)

candidate_code <- candidates %>%
  mutate(party = cand_party_affiliation) %>%
  filter(party == "DEM" | party == "REP") %>%
  select(cand_id, party, cand_state)
```

```{r, label = "merge data and extract info"}
contributions_state <- contribution_code %>%
  left_join(candidate_code, by = "cand_id") %>%
  filter(donor_state == cand_state, cand_state %in% state_list) %>%
  select(-donor_state) %>%
  mutate(state.2 = cand_state) %>%
  group_by(party, state) %>%
  summarize(sum = n(), num_cand = n_distinct(cand_id)) %>%
  mutate(don_cand = round(sum / num_cand)) %>%
  select(-sum, -num_cand)
```

```{r, label = "prepare data for graphic"}
dem_map <- contributions_state %>%
  filter(party == "DEM") %>%
  select(-party)

rep_map <- contributions_state %>%
  filter(party == "REP") %>%
  select(-party)
```

```{r, label = "plot graphics"}
states <- map_data("state")
#make function that assigns color (red/blue) and alpha (don_cand) to each region (state)
ggplot(data = states) +
  geom_polygon(aes(x = long, y = lat, fill = region), color = "white") +
  coord_fixed(1.3) +
  guides(fill = FALSE) #remove legend
```

```{r, label = "Addin Functions"}
insertInAddin <- function() {
  rstudioapi::insertText(" %in% ")
}

wordcountaddin <- function(){
  wordcountaddin::text_stats("my_file.Rmd")}

```

```{r}
#this is a sample data. 
data("fifty_states") # this line is optional due to lazy data loading

crimes <- data.frame(state = tolower(rownames(USArrests)), USArrests)

# map_id creates the aesthetic mapping to the state name column in your data
p <- ggplot(crimes, aes(map_id = state)) + 
  # map points to the fifty_states shape data
  geom_map(aes(fill = Assault), map = fifty_states) + 
  expand_limits(x = fifty_states$long, y = fifty_states$lat) +
  coord_map() +
  scale_x_continuous(breaks = NULL) + 
  scale_y_continuous(breaks = NULL) +
  labs(x = "", y = "") +
  theme(legend.position = "bottom", 
        panel.background = element_blank())

p
# add border boxes to AK/HI
p + fifty_states_inset_boxes() 
```

```{r}
data("fifty_states") # the issue that needs to be addressed. REP has 49 data values and DEM has 48. Which is an issue if we use fiftystater. I do not think that the issue is that the state labels are different. Fiftystater has the name of the state lower case and we have the abbrieviation. SO we could... fix that with join but I don't think that will fix it. So we gotta fixure out why there is missing data through the filtering process or we gotta see if we can somehow override this so that it doesn't return the error "neg interger."kk ily J
Demoncracy1 <- data.frame(state = tolower(rownames(dem_map)), dem_map)

# map_id creates the aesthetic mapping to the state name column in your data
p <- ggplot(Demoncracy1, aes(map_id = state)) + 
  # map points to the fifty_states shape data
  geom_map(aes(fill = don_cand), map = fifty_states) + 
  expand_limits(x = fifty_states$long, y = fifty_states$lat) +
  coord_map() +
  scale_x_continuous(breaks = NULL) + 
  scale_y_continuous(breaks = NULL) +
  labs(x = "", y = "") +
  theme(legend.position = "bottom", 
        panel.background = element_blank())

p
# add border boxes to AK/HI
p + fifty_states_inset_boxes() 


```
