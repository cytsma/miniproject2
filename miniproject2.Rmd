---
title: "The States That Support Their Own"
subtitle: "Mini Project 2"
author: "Cai Ytsma, Juliane Bombosh, Sofia Salcedo"
date: "3/22/2018"
output: html_document
  code_folding: hide
---
##Goal
We are looking at the top 5 states for democratic and republican parties that had the highest number of donations by donors from the same state as the candidates they were donating to. 

```{r, message = FALSE, warning = FALSE}
library(tidyverse)
library(maps)
library(mapdata)
```

```{r, label = "dataset import"}
load("house_elections.rda")
load("candidates.rda")
load("committees.rda")
load("contributions.rda")
```

```{r, label = "state list"}
state_list <- c("AL", "AZ", "AR", "CA", "CO", "CT",
               "DE", "FL", "GA", "HI", "ID",
               "IL", "IN", "IA", "KS", "KY", "LA", "ME",
               "MD", "MA", "MI", "MN", "MS", "MO", "MT", "NE",
               "NV", "NH", "NJ", "NM", "NY", "NC", "ND",
               "OH", "OK", "OR", "PA", "RI", "SC", 
               "SD", "TN", "TX", "UT", "VT", "VA", "WA", 
               "WV", "WI", "WY")
```

```{r, label = "prepare datasets for merge"}
contribution_code <- contributions %>%
  select(cand_id, state) %>%
  mutate(donor_state = state)

candidate_code <- candidates %>%
  mutate(party = cand_party_affiliation) %>%
  filter(party == "DEM" | party == "REP") %>%
  select(cand_id, party, cand_state)
```

```{r, label = "merge data and extract info"}
contributions_state <- contribution_code %>%
  left_join(candidate_code, by = "cand_id") %>%
  filter(donor_state == cand_state, cand_state %in% state_list) %>%
  select(-donor_state) %>%
  mutate(state = cand_state) %>%
  group_by(party, state) %>%
  summarize(sum = n(), num_cand = n_distinct(cand_id)) %>%
  mutate(don_cand = round(sum / num_cand)) %>%
  select(-sum, -num_cand)
```

```{r, label = "prepare data for graphic"}
dem_map <- contributions_state %>%
  filter(party == "DEM") %>%
  select(-party)

rep_map <- contributions_state %>%
  filter(party == "REP") %>%
  select(-party)
```

```{r, label = "plot graphics"}
states <- map_data("state")
#make function that assigns color (red/blue) and alpha (don_cand) to each region (state)
ggplot(data = states) +
  geom_polygon(aes(x = long, y = lat, fill = region), color = "white") +
  coord_fixed(1.3) +
  guides(fill = FALSE) #remove legend
```

<<<<<<< HEAD
=======
>>>>>>> 74d8768889c2a5d9509df4174effa16ff47d8ae4

```{r}
insertInAddin <- function() {
  rstudioapi::insertText(" %in% ")
}

 %in% 
```

=======
>>>>>>> 98e5865176d52f1c0f5f67f5113145b4040791a6
