---
title: "miniproject"
author: "Cai Ytsma, Juliane Bombosh, Sofia Salcedo"
date: "3/19/2018"
output: html_document
  code_folding: hide
---
Goal:
We are looking at the top 5 states for democratic and republican parties that had the highest number of donations by donors from the same state as the candidates they were donating to. 

```{r}
library(tidyverse)
```

```{r}
load("house_elections.rda")
load("candidates.rda")
load("committees.rda")
load("contributions.rda")
```

```{r}
state_list <- c("AL", "AK", "AS", "AZ", "AR", "CA", "CO", "CT",
               "DE", "DC", "FM", "FL", "GA", "GU", "HI", "ID",
               "IL", "IN", "IA", "KS", "KY", "LA", "ME", "MH",
               "MD", "MA", "MI", "MN", "MS", "MO", "MT", "NE",
               "NV", "NH", "NJ", "NM", "NY", "NC", "ND", "MP",
               "OH", "OK", "OR", "PW", "PA", "PR", "RI", "SC", 
               "SD", "TN", "TX", "UT", "VT", "VI", "VA", "WA", 
               "WV", "WI", "WY")
```

```{r}
contribution_code <- contributions %>%
  select(cand_id, state) %>%
  mutate(donor_state = state)

candidate_code <- candidates %>%
  mutate(party = cand_party_affiliation) %>%
  filter(party == "DEM" | party == "REP") %>%
  select(cand_id, party, cand_state)
```

```{r}
contributions_party <- contribution_code %>%
  left_join(candidate_code, by = "cand_id") %>%
  filter(donor_state == cand_state, cand_state %in% state_list) %>%
  group_by(party, cand_state) %>%
  summarize(sum = n(), num_cand = n_distinct(cand_id)) %>%
  mutate(don_cand = round(sum / num_cand))

contributions_dem <- contributions_party %>%
  filter(party == "DEM") %>%
  arrange(desc(don_cand)) %>%
  head(5)

contributions_rep <- contributions_party %>%
  filter(party == "REP") %>%
  arrange(desc(don_cand)) %>%
  head(5)
```
