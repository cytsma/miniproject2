---
title: "The States That Support Their Own"
subtitle: "Mini Project 2"
author: "Cai Ytsma, Juliane Bombosh, Sofia Salcedo"
date: "3/22/2018"
output: 
  html_document:
    code_folding: hide
---
# Relevance: 
**What we wanted to Achieve**
We analyzed FEC data to examine politically active local communities. We created two data graphics, one representing donations made to Democratic candidates, the other representing Republican candidates. We wanted to compare party affiliation and enthusiasm via donation frequency and examine the regions with higher political affiliation and why that might be.

#What We Did:
**Visual Cues & Data Source:**
Our data is from the candidates and contributions rda files. We utilized the image of a map and color saturation per state. Each state's saturation is based on the number of donations made to a candidate of that state. The higher the saturation the more donations were made to candidates of the repective party per state.

#Analysis:
a single coherent sentence what we can learn from these data
Looking at number of candidates, which should remove the bias of population
Where are dems or repus focusing donations? Where are the more active political regions?

Where would donations to candidates be the highest? Would it be in areas where there is high variability in the local political scene and donations can have more influence? Or in areas that are the opposite, with a stable majority in place?
Side note: throw something in to connect to the title of "donating to their own" and the idea of ignoring DC, outside influences

**Link to the repository** !!! NEEDS TO BE IN FOOTNOTES!!!

```{r, message = FALSE, warning = FALSE}
library(tidyverse)
library(maps)
library(mapdata)
library(ggplot2)

library(fiftystater)
library(devtools)
library(RColorBrewer)

```

```{r, label = "dataset import"}
load("house_elections.rda")
load("candidates.rda")
load("committees.rda")
load("contributions.rda")
```

```{r, label = "state list"}
state_inits <- c("AL", "AK", "AZ", "AR", "CA", "CO", "CT",
               "DE", "FL", "GA", "HI", "ID",
               "IL", "IN", "IA", "KS", "KY", "LA", "ME",
               "MD", "MA", "MI", "MN", "MS", "MO", "MT", "NE",
               "NV", "NH", "NJ", "NM", "NY", "NC", "ND",
               "OH", "OK", "OR", "PA", "RI", "SC", 
               "SD", "TN", "TX", "UT", "VT", "VA", "WA", 
               "WV", "WI", "WY")

state_names <- c("alabama", "alaska", "arizona", "arkansas", "california", "colorado", "connecticut", "delaware", "florida", "georgia", "hawaii", "idaho", "illinois", "indiana", "iowa", "kansas", "kentucky","louisiana", "maine", "maryland", "massachusetts", "michigan", "minnesota", "mississippi", "missouri", "montana", "nebraska", "nevada", "new hampshire", "new jersey", "new mexico", "new york", "north carolina", "north dakota", "ohio", "oklahoma", "oregon", "pennsylvania", "rhode island", "south carolina","south dakota", "tennessee", "texas", "utah", "vermont", "virginia", "washington", "west virginia", "wisconsin", "wyoming")

state_code <- data.frame(state_inits, state_names)
names(state_code) <- c("initials", "name")
```

```{r, label = "prepare datasets for merge"}
contribution_code <- contributions %>%
  select(cand_id, state) %>%
  group_by(state) %>%
  mutate(donor_state = state)

candidate_code <- candidates %>%
  mutate(party = cand_party_affiliation) %>%
  filter(party == "DEM" | party == "REP") %>%
  select(cand_id, party, cand_state)
```

```{r, label = "merge data and extract info", warning = FALSE}
contributions_state <- contribution_code %>%
  left_join(candidate_code, by = "cand_id") %>%
  filter(donor_state == cand_state) %>%
  select(-donor_state) %>%
  left_join(state_code, by = c("cand_state" = "initials")) %>%
  filter(!is.na(name)) %>%
  group_by(party, name) %>%
  summarize(sum = n(), num_cand = n_distinct(cand_id)) %>%
  mutate(don_cand = round(sum / num_cand)) %>%
  select(-sum, -num_cand)
```

```{r, label = "plot graphics", warning = FALSE, message = FALSE}
makeplot <- function(party1, color1) {
  
  states <- map_data("state")
  
  temp <- contributions_state %>% 
            filter(party == party1) %>%
            select(-party)
  
  temp2 <- states %>%
            left_join(temp, by = c("region" = "name")) %>%
            arrange(order)
  
  ggplot(data = temp2) +
    geom_polygon(aes(x = long, y = lat, fill = don_cand, group = region)) +
    coord_fixed(1.3) +
    scale_x_continuous(breaks = NULL) + 
    scale_y_continuous(breaks = NULL) +
    scale_fill_distiller(palette = color1) +
    labs(x = "", y = "") +
    theme(legend.position = "bottom", 
          panel.background = element_blank(),
          title = element_text(color= "#565151")
          )
}
```

```{r, warning = FALSE, message = FALSE}
makeplot("REP", "Reds") +
    labs(title= "Donations Made to Republican Candidates", caption="Source: airquality")

makeplot("DEM", "Blues")+
    labs(title= "Donations Made to Democrat Candidates", caption="Source: candidates.rda, contributions.rda")

```

